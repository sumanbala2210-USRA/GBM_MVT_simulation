# simulation_ALL.yaml
# ===================================================================
#  1. PROJECT SETTINGS
# ===================================================================
# Global settings for the entire project, read by all scripts.
project_settings:
  # The base directory for all generated event files.
  data_path: '001_DATA' # where your simulation data will be stored
  results_path: '01_ANALYSIS_RESULTS' # where your analysis results will be stored
  haar_python_path: "/Users/sbala/anaconda3/bin/python" # path to the Haar Python executable
  #pulse_path: 

# ===================================================================
#  2. PULSE DEFINITIONS (The "Library")
# ===================================================================
# Define all known pulse shapes and their specific parameters here ONCE.
# Campaigns below will refer to these by name.
pulse_definitions:
  gaussian:
    parameters:
      sigma: [0.01] #, 0.005, 0.02, 0.001] #, 0.005, 0.01, 0.05, 0.1, 0.5, 1.0]
      #sigma: [0.05, 0.01] # [0.01, 0.05, 0.1, 0.5, 1.0]
    constants:
      center_time: 0.0

  triangular:
    parameters:
      width: [0.0001, 0.0005, 0.001, 0.005, 0.01, 0.05, 0.1, 0.5, 1.0] #[0.01, 0.05] #, 0.001, 0.005, 0.01, 0.05, 0.1, 0.5, 1.0]
    constants:
      center_time: 0.0
      peak_time_ratio: 0.5

  norris:
    parameters:
      rise_time: [0.0001, 0.0005, 0.001, 0.005, 0.01, 0.05, 0.1, 0.5]
      decay_time: [0.01, 0.02, 0.05, 0.1, 0.2, 0.5]
    constants:
      start_time: 0.0
  
  fred:
    parameters:
      # NOTE: Combined values from both of your original campaigns
      rise_time: [.1] #[0.0001, 0.0005, 0.001, 0.005, 0.01, 0.05, 0.1, 0.5, 1.0]
      decay_time: [.2] #[0.01, 0.02, 0.05, 0.1, 0.2, 0.5, 1.0]
    constants:
      start_time: 0.0

  lognormal:
    parameters:
      sigma: [.1] #[0.0001, 0.0005, 0.001, 0.005, 0.01, 0.05, 0.1, 0.5, 1.0]
      center_time: [.2] #[0.01, 0.02, 0.05, 0.1, 0.2, 0.5, 1.0]
  
  complex_pulse:
    parameters:
      # This is the second argument to your wrapper ('position')
      position: [4.0, 6.0, 8.0, 10, 12, 14] #, 6.0]
    constants: {}

# ===================================================================
#  3. SIMULATION CAMPAIGNS
# ===================================================================
# Each campaign defines a set of simulations to generate.
# This section is read by 'generate_events.py'.


# ______________________________________
#  GBM
# ______________________________________
simulation_campaigns:
- name: GBM_Pulse_Simulation
  type: gbm
  enabled: false

  # Parameters that vary for this entire campaign
  parameters:
    peak_amplitude: [0.1, 0.2, 0.3, 0.4, 0.5, 1.0]
    all_flag: true
    trigger_set:
      - {trigger_number: 250709653, angle: 20, det: 'all', background_intervals: [[-20, -5.0],[75, 200]]}
      #- {trigger_number: 250723551, angle: 30, det: ['n3'], background_intervals: [[-15, -5.0], [80, 210]]}
      #- {trigger_number: 250709653, angle: 40, det: ['n3'], background_intervals: [[-20, -5.0, 75, 200]]}

  # Constants for this entire campaign
  constants:
    background_level: 1
    random_seed: 37
    t_start: 0.0
    t_stop: 15.0
    en_lo: 8.0
    en_hi: 900.0
    gbm_data_path: None
    total_sim: 300


  # List the pulse shapes from the library you want to run in this campaign.
  pulses_to_run:
    - gaussian
    # - triangular
    # - norris
    # - fred
    # - lognormal
    - complex_pulse  # Example of enabling a pulse for this campaign
# ______________________________________
#  Functions
# ______________________________________

- name: FUNCTION_Pulse_Simulation
  type: function
  enabled: true 

  parameters:
    peak_amplitude:  [1, 2, 3, 4, 5] # 10, 20, 50] # 100, 200] #, 500]

  constants:
    trigger_number: 99999999
    det: x
    angle: 0
    t_start: 0.0
    t_stop: 15.0
    background_level: 1
    scale_factor: 1000
    random_seed: 37
    grid_resolution: 0.001
    total_sim: 30

  # This campaign will only run the gaussian and norris simulations.
  pulses_to_run:
    - gaussian
    # - triangular  # Example of disabling a pulse for this campaign
    # - norris
    # - fred
    # - lognormal
    # - complex_pulse  # Example of enabling a pulse for this campaign

# ===================================================================
#  4. ANALYSIS SETTINGS
# ===================================================================
# This section is read by your 'analyze.py' script.
analysis_settings:
  # The analysis script will test every event file against these bin widths
  bin_widths_to_analyze_ms: [1, 0.1] #, 0.001] #, 0.001] #, 0.01]
  snr_timescales: [0.010, 0.016, 0.032, 0.064, 0.128, 0.256]
  #detector_selections: [['n2', 'na'], ['all'] ] # [ ['n0'], ['n2', 'na'], ['all'] ]
  extra_pulse: { pulse_shape: 'gaussian', sigma: 0.02, center_time: 0.0 }
  #detector_selections: [ ['all'] ]
